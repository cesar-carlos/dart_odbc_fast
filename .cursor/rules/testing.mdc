---
description: Testing conventions and quality standards
globs: ["test/**/*.dart"]
alwaysApply: true
---

# Testing Standards

## Structure

- Mirror production folder structure in `test/`.
- Group by layer (domain, application, infrastructure, integration).

## Test Design

- Follow AAA: Arrange, Act, Assert.
- Keep tests deterministic and isolated.
- Use descriptive names: `should_<behavior>_when_<condition>`.
- Validate behavior, not implementation details.

## Mocks and Fakes

- Mock external boundaries only (network, DB, platform APIs).
- Prefer real domain entities/value objects in unit tests.
- Use fakes when behavior matters more than call verification.

## Assertions

- Prefer clear, expressive assertions.
- Keep one main behavior expectation per test.
- Add additional assertions only when they describe the same behavior contract.

## Coverage Guidance

- Prioritize critical paths and error handling.
- Cover boundary conditions and null/empty inputs.
- Add regression tests for every confirmed bug.

## Checklist

- [ ] Test names are behavior-oriented.
- [ ] Tests are independent and deterministic.
- [ ] External dependencies are isolated correctly.
- [ ] Critical and error paths are covered.
